@using ClientDependency.Core.Mvc
@using Escc.ClientDependencyFramework
@using Escc.EastSussexGovUK.MasterPages
@using Escc.EastSussexGovUK.MasterPages.Features
@using EsccWebTeam.EastSussexGovUK
@using EsccWebTeam.EastSussexGovUK.MasterPages
@inherits Umbraco.Web.Mvc.UmbracoViewPage<Escc.EastSussexGovUK.Umbraco.Models.PersonViewModel>
@{
    Model.EsccWebsiteView = ViewSelector.CurrentViewIs(Layout);
    Model.EsccWebsiteSkin = new CustomerFocusSkin(Model.EsccWebsiteView);

    Html.Partial("~/Views/Layouts/_FeatureDependencies.cshtml", new List<IClientDependencySet>()
    {
        new EmbeddedYouTubeVideos() { Html = new [] { Model.LeadingText.ToString(), Model.Content1.ToString(), Model.Content2.ToString(), Model.Contact.ToString() }},
        new EmbeddedGoogleMaps() { Html = new [] { Model.LeadingText.ToString(), Model.Content1.ToString(), Model.Content2.ToString(), Model.Contact.ToString() }},
        new EastSussex1SpaceSearch() { ShowEastSussex1SpaceSearch = Model.ShowEastSussex1SpaceWidget },
        new EscisSearch() { ShowEscisSearch = Model.ShowEscisWidget },
        new FacebookLikeBox() { SocialMedia = Model.SocialMedia, EsccWebsiteView = Model.EsccWebsiteView },
        new TwitterWidget() { SocialMedia = Model.SocialMedia, EsccWebsiteView = Model.EsccWebsiteView },
        new WebChat() { WebChatSettings = Model.WebChat }
    });
}
@section Metadata
{
    <title>@Model.JobTitle &#8211; @Model.Person.Name &#8211; East Sussex County Council</title>
}

<div class="article task">
    <article>
        <div class="content text-content">

            <h1>@Model.JobTitle &#8211; @Model.Person.Name</h1>

            @Html.Partial("~/Views/Layouts/_Latest.cshtml")

            @if (!String.IsNullOrWhiteSpace(@Model.LeadingText.ToString()))
            {
                <div class="lead">
                    @Model.LeadingText
                </div>
            }

            @if (!String.IsNullOrWhiteSpace(@Model.Subheading1))
            {
                <h2>@Model.Subheading1</h2>
            }
            @Model.Content1

            @if (!String.IsNullOrWhiteSpace(@Model.Subheading2))
            {
                <h2>@Model.Subheading2</h2>
            }
            @Model.Content2
            @if (Model.Person.EmailAddresses.Any() || Model.Person.TelephoneNumbers.Any() || !String.IsNullOrEmpty(Model.Contact.ToHtmlString()))
            {
                <h2>Contact</h2>
                if (Model.Person.TelephoneNumbers.Any())
                {
                     <p>Phone: @Model.Person.TelephoneNumbers[0].NationalNumber</p>
                }
                if (Model.Person.EmailAddresses.Any())
                {
                    var transformer = new WebsiteFormEmailAddressTransformer(Request.Url);
                    <p>Email: <a href="@transformer.TransformEmailAddress(Model.Person.EmailAddresses[0])">@Model.Person.Name</a></p>
                }
                @Model.Contact
            }
        </div>
    </article>
</div>

@if (Model.Photo != null)
{
    <img src="@Model.Photo.ImageUrl" alt="@Model.Photo.AlternativeText" width="@Model.Photo.Width" class="supporting" />
}

@Html.Partial("~/Views/Partials/_RelatedLinks.cshtml", Model.RelatedLinksGroups)

@foreach (var socialMedia in Model.SocialMedia.SocialMediaOrder)
{
    @Html.Partial("~/Views/Layouts/_" + socialMedia + ".cshtml")
}
@Html.Partial("~/Views/Layouts/_SupportingContentDesktop.cshtml")
<div class="text-content content">
    @Html.Partial("~/Views/Layouts/_Share.cshtml")
</div>
@section JavaScript
{
    <script type="application/ld+json">
{
"@@context": "http://schema.org",
"@@type": "Person",
"honorificPrefix": "@Model.Person.Name.Titles",
"givenName": "@Model.Person.Name.GivenNames",
"familyName": "@Model.Person.Name.FamilyName",
"honorificSuffix": "@Model.Person.Name.Suffixes",
"name": "@Model.Person.Name",
@if (Model.Person.EmailAddresses.Any())
{
@:"email": "@Model.Person.EmailAddresses[0]",
}
@if (Model.Person.TelephoneNumbers.Any())
{
@:"telephone": "@Model.Person.TelephoneNumbers[0]",
}
"jobTitle": "@Model.JobTitle",
"worksFor": {
        "@@id": "https://www.eastsussex.gov.uk#id",
        "@@type": "Organization",
        "name": "East Sussex County Council"
    }
}
</script>
}