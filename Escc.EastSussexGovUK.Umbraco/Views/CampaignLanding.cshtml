@using ClientDependency.Core.Mvc
@using Escc.ClientDependencyFramework
@using Escc.EastSussexGovUK.Skins
@using Escc.EastSussexGovUK.Views
@using Escc.Web
@inherits Umbraco.Web.Mvc.UmbracoViewPage<Escc.EastSussexGovUK.Umbraco.Models.CampaignLandingViewModel>
@{
    Model.EsccWebsiteView = ViewSelector.CurrentViewIs(Layout, ViewEngine.Mvc);
    Model.EsccWebsiteSkin = new CustomerFocusSkin(Model.EsccWebsiteView);

    Html.RequiresCss(CssFileAlias.Resolve("CampaignSmall"));
    Html.RequiresCss(Request.Url.AbsolutePath + "?alttemplate=CampaignLandingCss&media-query=small", 101);
    if (Model.EsccWebsiteView == EsccWebsiteView.Desktop)
    {
        Html.RequiresCss(CssFileAlias.Resolve("CampaignMedium"), MediaQueryAlias.Resolve("Medium"));
        Html.RequiresCss(CssFileAlias.Resolve("CampaignLarge"), MediaQueryAlias.Resolve("Large"));
        Html.RequiresCss(Request.Url.AbsolutePath + "?alttemplate=CampaignLandingCss&media-query=medium", 101, MediaQueryAlias.Resolve("Medium"));
        Html.RequiresCss(Request.Url.AbsolutePath + "?alttemplate=CampaignLandingCss&media-query=large", 101, MediaQueryAlias.Resolve("Large"));

    }
    Html.RequiresCss(CssFileAlias.Resolve("CampaignPrint"), new Dictionary<string, string>() { { "media", "print" } });
    Html.RequiresJs(JsFileAlias.Resolve("CampaignLanding"), 1000);

    if (Model.LandingNavigation.Sections.Count > 0)
    {
        Html.RequiresCss(CssFileAlias.Resolve("NavigationSmall"));
        if (Model.EsccWebsiteView == EsccWebsiteView.Desktop)
        {
            Html.RequiresCss(CssFileAlias.Resolve("NavigationMedium"), MediaQueryAlias.Resolve("Medium"));
            Html.RequiresCss(CssFileAlias.Resolve("NavigationLarge"), MediaQueryAlias.Resolve("Large"));
        }
    }

    var policy = new ContentSecurityPolicyHeaders(Response.Headers);
    policy.AppendPolicy(new ContentSecurityPolicyFromConfig().Policies["YouTube"]);
    policy.UpdateHeaders();
}
@section BodyClass {
    campaign-landing
}
<div class="full-page" data-video-height="@Model.VideoHeight">
    <div class="lead">
        <h1>@Model.Metadata.Title</h1>
        @if (!String.IsNullOrEmpty(Model.Introduction.ToHtmlString()))
        {
            var alignIntroMedium = (Model.AlignIntroductionMedium == "Left" || Model.AlignIntroductionMedium == "Right") ? "medium-" + Model.AlignIntroductionMedium.ToLowerInvariant() : String.Empty;
            var alignIntroLarge = (Model.AlignIntroductionLarge == "Left" || Model.AlignIntroductionLarge == "Right") ? "large-" + Model.AlignIntroductionLarge.ToLowerInvariant() : String.Empty;
            <div class="intro @alignIntroMedium @alignIntroLarge">@Model.Introduction</div>
        }
        @if (Model.LandingNavigation.Sections.Count > 0)
        {
            var alignLandingNavMedium = (Model.AlignLandingNavigationMedium == "Left" || Model.AlignLandingNavigationMedium == "Right") ? "medium-" + Model.AlignLandingNavigationMedium.ToLowerInvariant() : String.Empty;
            var alignLandingNavLarge = (Model.AlignLandingNavigationLarge == "Left" || Model.AlignLandingNavigationLarge == "Right") ? "large-" + Model.AlignLandingNavigationLarge.ToLowerInvariant() : String.Empty;
            <div class="text-content landing-nav @alignLandingNavMedium @alignLandingNavLarge">
                @Html.Partial("~/Views/Layouts/_LandingNavigation.cshtml", Model.LandingNavigation)
            </div>
        }
    </div>

    @if (Model.ButtonTargets.Any())
    {
        var alignButtonsMedium = (Model.AlignButtonsMedium == "Left" || Model.AlignButtonsMedium == "Right") ? "medium-" + Model.AlignButtonsMedium.ToLowerInvariant() : String.Empty;
        var alignButtonsLarge = (Model.AlignButtonsLarge == "Left" || Model.AlignButtonsLarge == "Right") ? "large-" + Model.AlignButtonsLarge.ToLowerInvariant() : String.Empty;
        <div class="buttons @alignButtonsMedium @alignButtonsLarge">
            @{
                var i = 0;
                foreach (var link in Model.ButtonTargets)
                {
                    <a href="@link.Url" class="button-@(i + 1)">
                        <h2>@link.Text</h2>
                        <p>@Model.ButtonDescriptions.ElementAt(i)</p>
                    </a>
                    i++;
                }
            }
        </div>
    }
    @if (!String.IsNullOrWhiteSpace(Model.Content.ToHtmlString()))
    {
        <div class="text-content landing-content">
            @Model.Content
        </div>
    } 
    <div class="text-content share-container">
        @Html.Partial("~/Views/EastSussexGovUK/Features/_Share.cshtml", Model)
    </div>
</div>